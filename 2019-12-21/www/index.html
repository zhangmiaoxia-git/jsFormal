<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
<style>
    #box{
        width:100px;
        height:100px;
        background:red;
    }
</style>
</head>
<body>
    <!-- <div id="box"></div> -->
    用户名: <input type="text" id="us">
    密码: <input type="password" id="pw">
    <button id="btn">注册</button>
<script>
    us.onblur = async function(){
        let data = await fetch('/post',{
            method:'post',
            body:'user='+us.value,
            headers:{
                'content-type':'application/x-www-form-urlencoded'
            }
        }).then(e=>e.json());
        if(data.code === 0){
            this.style.border = '1px solid green';
        }else if(data.code === 1){
            this.style.border = '1px solid red';
        }
    }
    // us.onblur = async function(){
    //     let data = await fetch('/getname?user='+this.value).then(e=>e.json());
    //     console.log(data);
    //     if(data.code === 0){
    //         this.style.border = '1px solid green';
    //     }else if(data.code === 1){
    //         this.style.border = '1px solid red';
    //     }
    // }

    btn.onclick = function(){
        fetch('/register?user='+us.value+'&password='+pw.value).then(d=>d.json()).then(data=>{
            if(data.code === 0){
                alert(data.msg);
            }else if(data.code === 1){
                alert(data.msg);
            }else if(data.code === 2){
                alert(data.msg);
            }
        });
    }
</script>
</body>
</html>